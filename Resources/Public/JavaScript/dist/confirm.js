import o from"@typo3/backend/modal.js";import n from"@typo3/backend/notification.js";import c from"nprogress";class p{constructor(){[...document.querySelectorAll(".confirm")].forEach(function(i){i.addEventListener("click",function(r){r.preventDefault();let t=r.target;r.target.classList.contains("confirm")||(t=r.target.closest(".confirm"));const a=t.hasAttribute("href")?t.getAttribute("href"):t.getAttribute("data-url"),u=t.getAttribute("data-title"),l=t.getAttribute("data-content"),f=t.getAttribute("data-button-ok-text"),d=t.getAttribute("data-button-ok-class"),g=t.getAttribute("data-button-close-text"),m=t.getAttribute("data-severity"),s=t.getAttribute("data-redirect");o.confirm(u,l,m,[{text:f,btnClass:d||"btn-default",active:!0,trigger:function(){c.configure({parent:".module-loading-indicator",showSpinner:!0}),c.start();const e=new XMLHttpRequest;e.open("POST",a),e.send(),e.onload=function(){if(e.status==200){const b=JSON.parse(e.response);n.success("Success",b.message,5),s&&window.location.replace(s)}else n.error("Ooops","An error occurred",5)},e.onerror=function(){n.error("Ooops","An error occurred",5)},o.dismiss()}},{text:g,trigger:function(){o.dismiss()}}])})})}}export default new p;
